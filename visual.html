<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visual | Mila Baumann</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Gilda+Display&display=swap"
    rel="stylesheet" />

  <style>
    :root {
      --red: #e91511;
      --darkred: #7c0004;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      min-height: 100vh;
      background: var(--red);
      color: var(--darkred);
      font-family: "Gilda Display", serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    /* Right-side vertical nav — same as index.html */
    .nav {
      position: fixed;
      inset-block: 0;
      right: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-end;
      gap: 1rem;
      padding: 2rem;
      margin-top: -28rem;
      z-index: 3;
    }

    .btn {
      font-size: 2.3rem;
      font-weight: 700;
      text-decoration: none;
      color: var(--darkred);
      transition: opacity .2s ease, transform .2s ease;
    }

    .btn:hover {
      opacity: .7;
      transform: translateX(-3px);
    }

    .thumb {
      display: inline-block;
      border: none;
      background: transparent;
      padding: 0;
      cursor: pointer;
    }

    .thumb img {
      height: 300px;
      /* strip height */
      width: auto;
      display: block;
      object-fit: contain;
      user-select: none;
      -webkit-user-drag: none;
      transition: transform .18s ease, opacity .18s ease;
      border: none;
      outline: none;
      box-shadow: none;
      background: transparent;
    }

    .thumb:hover img {
      transform: scale(1.02);
      opacity: .95;
    }

    /* Header sits close to the carousel */
    .hero {
      width: 100%;
      padding: .5rem 2rem 0;
    }

    /* tighter */
    .title {
      font-family: "Inter", serif;
      margin-top: 15.25rem;
      /* much less space */
      font-size: clamp(3rem, 9vw, 9rem);
      font-weight: 900;
      text-transform: uppercase;
      line-height: 1;
      margin-bottom: 0rem;
      color: var(--darkred);
    }

    .jump {
      position: relative;
       z-index: 10;
      text-align: right;
      padding-right: 1rem;
      margin-top: 0rem;
      /* you can keep 3rem if you prefer the space */
    }



    .jump a {
      text-align: right;
      display: inline-block;
      pointer-events: auto;
      font-family: "Inter", sans-serif;
      font-weight: 800;
      text-decoration: none;
      color: var(--darkred);
      font-size: 1.25rem;
      border-bottom: 2px solid rgba(140, 0, 4, .35);
      transition: opacity .2s ease, border-color .2s ease, transform .2s ease;
    }

    .jump a:hover {
      opacity: .75;
      border-color: rgba(140, 0, 4, .35);
      transform: translateY(-1px);
    }

    /* Gallery section (masonry columns) */
    .gallery {
      max-width: 1300px;
      padding: 0 2rem 3rem;
      position: relative;
      z-index: 1;
    }

    #gallery-section {
      scroll-margin-top: 16px;
      /* adjust if you want more space on arrival */
    }

    /* Carousel strip under nav (top of page) */
    .carousel-section {
      width: 100%;
      padding: 2rem 0 .25rem;
      /* tighter top + bottom */
      position: relative;
      z-index: 1;
      margin-bottom: 20rem;
    }

    .carousel-viewport {
      width: 100%;
      overflow: hidden;
      padding-right: 14rem;
      /* keep clear of right nav */
    }

    .carousel-track {
      display: flex;
      gap: 12px;
      align-items: center;
      will-change: transform;
    }

    .grid {
      column-count: 4;
      column-gap: 16px;
    }

    @media (max-width: 900px) {
      .grid {
        column-count: 2;
      }
    }

    @media (max-width: 560px) {
      .grid {
        column-count: 1;
      }
    }

    .gthumb {
      display: block;
      break-inside: avoid;
      margin-bottom: 16px;
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .gthumb img {
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      transition: transform .18s ease;
      user-select: none;
      -webkit-user-drag: none;
      border: none;
      outline: none;
      box-shadow: none;
      background: transparent;
    }

    .gthumb:hover img {
      transform: scale(1.01);
    }

    /* Lightbox */
    dialog#lightbox {
      border: none;
      padding: 0;
      background: transparent;
      width: auto;
      height: auto;
      max-width: none;
      max-height: none;
      overflow: visible;
    }

    dialog::backdrop {
      background: rgba(0, 0, 0, .7);
    }

    .lb-wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 24px;
    }

    .lb-img {
      max-width: 95vw;
      max-height: 95vh;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0;
      background: transparent;
      border: none;
      box-shadow: none;
    }

    .lb-close {
      position: fixed;
      top: 16px;
      right: 18px;
      z-index: 1001;
      font-size: 34px;
      line-height: 1;
      color: #fff;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0 8px;
      user-select: none;
    }

    .lb-close:focus {
      outline: 2px solid rgba(255, 255, 255, .6);
      outline-offset: 4px;
    }

    /* Mobile */
    @media (max-width:700px) {
      .nav {
        flex-direction: row;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        top: 0;
        right: 0;
        padding: 1rem;
        margin-top: 0;
      }

      .btn {
        font-size: 1rem;
      }

      .carousel-section {
        padding-top: 5rem;
      }

      .carousel-viewport {
        padding-right: 0;
      }

      .thumb img {
        height: 110px;
      }

      .hero {
        padding: 1rem 1rem 0;
        text-align: center;
      }

      .title {
        margin-top: 1rem;
      }

      .jump {
        padding: .5rem 1rem 1rem;
        text-align: center;
      }

      .gallery {
        padding: 0 1rem 2.5rem;
      }
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {

      .thumb img,
      .gthumb img {
        transition: none;
      }
    }
  </style>
</head>

<body>
  <nav class="nav" aria-label="Primary">
    <a class="btn btn-home" href="index.html">Home</a>
    <a class="btn btn-about" href="aboutme.html">About Me</a>
    <a class="btn btn-visual" href="visual.html">Visual</a>
    <a class="btn btn-music" href="music.html">Music</a>
    <a class="btn btn-contact" href="contact.html">Contact</a>
  </nav>

  <section class="hero" aria-labelledby="page-title">
    <h1 id="page-title" class="title">Visual</h1>
  </section>
  <div class="jump">
    <a href="#gallery-section" aria-label="Jump to gallery view">Gallery view ↓</a>
  </div>

  <!-- Horizontal, slowly auto-scrolling carousel strip -->
  <section class="carousel-section" aria-label="Visual carousel">
    <div class="carousel-viewport" id="carouselViewport">
      <div class="carousel-track" id="carouselTrack" aria-live="off"></div>
    </div>
  </section>

  <main>


    <!-- Minimal button that scrolls down to the full gallery -->

    <!-- Full gallery (masonry) -->
    <section id="gallery-section" class="gallery" aria-label="Gallery view">
      <div id="galleryGrid" class="grid"></div>
    </section>
  </main>

  <!-- Lightbox -->
  <dialog id="lightbox" aria-labelledby="lbHeading">
    <button class="lb-close" id="closeBtn" aria-label="Close">×</button>
    <div class="lb-wrap">
      <img id="lbImg" class="lb-img" alt="">
    </div>
    <h2 id="lbHeading" style="position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;">Image
      viewer</h2>
  </dialog>

  <script>
    const track = document.getElementById('carouselTrack');
    const viewport = document.getElementById('carouselViewport');
    const gridEl = document.getElementById('galleryGrid');

    const lightbox = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const closeBtn = document.getElementById('closeBtn');

    let items = [];          // [{file, title, url}]
    let currentIndex = 0;

    // Auto-scroll state
    let pos = 0;             // translateX position
    let speed = 40;          // px/s (slow)
    let lastTs = null;
    let stripWidth = 0;      // width of one content loop
    let paused = false;

    function friendlyTitle(name) {
      const base = name.replace(/\.[^.]+$/, '');
      return base.replace(/[_-]+/g, ' ').trim();
    }

    function buildCarouselThumb(item, i) {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'thumb';
      btn.setAttribute('aria-label', `Open ${item.title}`);
      btn.addEventListener('click', () => openLightbox(i));

      const img = document.createElement('img');
      img.src = item.url;
      img.alt = item.title;
      img.loading = 'lazy';
      img.decoding = 'async';

      btn.appendChild(img);
      return btn;
    }

    function buildGalleryThumb(item, i) {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'gthumb';
      btn.setAttribute('aria-label', `Open ${item.title}`);
      btn.addEventListener('click', () => openLightbox(i));

      const img = document.createElement('img');
      img.src = item.url;
      img.alt = item.title;
      img.loading = 'lazy';
      img.decoding = 'async';

      btn.appendChild(img);
      return btn;
    }

    function renderGallery() {
      gridEl.innerHTML = '';
      items.forEach((it, i) => gridEl.appendChild(buildGalleryThumb(it, i)));
    }

    function buildCarousel() {
      track.innerHTML = '';
      // first loop
      items.forEach((it, i) => track.appendChild(buildCarouselThumb(it, i)));
      // duplicate for seamless loop
      items.forEach((it, i) => track.appendChild(buildCarouselThumb(it, i + items.length)));

      // measure after images settle
      requestAnimationFrame(() => {
        stripWidth = 0;
        const kids = Array.from(track.children).slice(0, items.length);
        kids.forEach(el => { stripWidth += el.getBoundingClientRect().width + 12; }); // 12px gap
      });
    }

    function openLightbox(index) {
      currentIndex = ((index % items.length) + items.length) % items.length;
      const it = items[currentIndex];
      lbImg.src = it.url;
      lbImg.alt = it.title;
      if (!lightbox.open) lightbox.showModal();
      document.documentElement.style.overflow = 'hidden';
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      if (lightbox.open) lightbox.close();
      lbImg.src = '';
      document.documentElement.style.overflow = '';
      document.body.style.overflow = '';
    }

    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => { if (e.target === lightbox) closeLightbox(); });
    window.addEventListener('keydown', (e) => {
      if (!lightbox.open) return;
      if (e.key === 'Escape') closeLightbox();
    });

    // Pause auto-scroll on hover/focus
    viewport.addEventListener('mouseenter', () => paused = true);
    viewport.addEventListener('mouseleave', () => paused = false);
    viewport.addEventListener('focusin', () => paused = true);
    viewport.addEventListener('focusout', () => paused = false);

    // Very slow, seamless auto-scroll
    function tick(ts) {
      if (lastTs == null) lastTs = ts;
      const dt = (ts - lastTs) / 1000;
      lastTs = ts;

      const motionOK = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      if (motionOK && !paused && stripWidth > 0) {
        pos -= speed * dt;
        if (-pos >= stripWidth) pos += stripWidth; // loop
        track.style.transform = `translateX(${pos}px)`;
      }
      requestAnimationFrame(tick);
    }

    async function init() {
      try {
        const res = await fetch('visual.json');
        const data = await res.json();
        items = (data.visuals || []).map(file => ({
          file,
          title: friendlyTitle(file),
          url: `visual/${encodeURI(file)}`
        }));
        buildCarousel();
        renderGallery();
        requestAnimationFrame(tick);
      } catch (err) {
        track.innerHTML = '<p style="padding:1rem">Could not load visuals.json.</p>';
        gridEl.innerHTML = '<p style="padding:1rem">Could not load visuals.json.</p>';
        console.error(err);
      }
    }
    init();
  </script>
</body>

</html>